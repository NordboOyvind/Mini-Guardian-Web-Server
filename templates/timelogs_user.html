{% extends 'base.html' %}
{% block title %}Time Logging for {{ user.alias or user.email }}{% endblock %}
{% block content %}
<h2>Time Logging — {{ user.alias or user.email }}</h2>
<p>Alle hele uker (man-søn), nyeste uke øverst. Ingen ny uke før forrige er ferdig.</p>

{% if weeks and weeks|length > 0 %}
  {% for week in weeks %}
  <div style="margin-bottom:2em;">
    <h3>Uke: {{ week.week_start.strftime('%Y-%m-%d') }} – {{ week.week_end.strftime('%Y-%m-%d') }}</h3>
    <table>
      <thead>
        <tr><th>Date</th><th>Weekday</th><th>Hours</th><th>Minutes</th><th>Kilde</th>{% if current_user.is_editor() %}<th>Juster</th>{% endif %}</tr>
      </thead>
      <tbody>
      {% for d in week.per_day %}
        <tr>
          <td>{{ d.date[:10] }}</td>
          <td>{{ d.weekday }}</td>
          <td>{{ d.hours }}</td>
          <td>{{ d.minutes }}</td>
          <td>{{ d.source }}</td>
          {% if current_user.is_editor() %}
          <td>
            <form method="post" style="display:inline;">
              <input type="hidden" name="date" value="{{ d.date }}">
              <input type="number" name="total_minutes" min="0" max="1440" value="{{ d.total_minutes }}" style="width:5em;"> min
              <button type="submit">Juster</button>
            </form>
          </td>
          {% endif %}
        </tr>
      {% endfor %}
      </tbody>
      <tfoot>
        <tr style="background-color: rgba(255,255,255,.04); font-weight: bold;">
          <td colspan="3" style="text-align: right; padding-right: 2em;">WEEK TOTAL</td>
          <td colspan="3" style="text-align: center; padding-left: 1em;">{{ week.week_total }}</td>
        </tr>
      </tfoot>
    </table>
  </div>
  {% endfor %}
{% else %}
  <p>Ingen hele uker (man-søn) med data å vise ennå.</p>
{% endif %}
{% endblock %}
